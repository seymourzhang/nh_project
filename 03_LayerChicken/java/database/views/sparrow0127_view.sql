CREATE OR REPLACE VIEW s_user_house_view_temp AS select `a`.`user_id` AS `user_id`,`a`.`farm_id` AS `farm_id`,`a`.`house_id` AS `house_id` from `sparrow_lc`.`s_b_user_house` `a` where (1 = 1) union all select `ur`.`user_id` AS `user_id`,`uf`.`farm_id` AS `farm_id`,`dh`.`id` AS `house_id` from ((`sparrow_lc`.`s_b_user_role` `ur` join `sparrow_lc`.`s_b_user_farm` `uf`) join `sparrow_lc`.`s_d_house` `dh`) where ((1 = 1) and (`ur`.`user_id` = `uf`.`user_id`) and (`uf`.`farm_id` = `dh`.`farm_id`) and (`ur`.`role_id` <> 4))
 ;
CREATE OR REPLACE VIEW s_user_house_view AS select `data`.`user_id` AS `user_id`,`data`.`farm_id` AS `farm_id`,`data`.`house_id` AS `house_id` from `sparrow_lc`.`s_user_house_view_temp` `data` where ((1 = 1) and exists(select 1 from `sparrow_lc`.`s_d_house` where ((`data`.`house_id` = `sparrow_lc`.`s_d_house`.`id`) and (`sparrow_lc`.`s_d_house`.`freeze_status` = 0))) and exists(select 1 from `sparrow_lc`.`s_d_farm` where ((`data`.`farm_id` = `sparrow_lc`.`s_d_farm`.`id`) and (`sparrow_lc`.`s_d_farm`.`freeze_status` = 0))) and exists(select 1 from `sparrow_lc`.`s_d_user` where ((`data`.`user_id` = `sparrow_lc`.`s_d_user`.`id`) and (`sparrow_lc`.`s_d_user`.`freeze_status` = 0))))
 ;